"use strict";(globalThis.webpackChunkphysical_ai_book=globalThis.webpackChunkphysical_ai_book||[]).push([[5185],{157:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>h,frontMatter:()=>l,metadata:()=>a,toc:()=>o});var i=r(4848),s=r(8453);const l={title:"ROS 2 with Python - rclpy Usage",description:"Introduction to using ROS 2 with Python through the rclpy client library",tags:["ROS 2","Python","rclpy","Robotics","Programming"]},t="ROS 2 with Python - rclpy Usage",a={id:"week-3-5/ros2-python-rclpy",title:"ROS 2 with Python - rclpy Usage",description:"Introduction to using ROS 2 with Python through the rclpy client library",source:"@site/docs/week-3-5/ros2-python-rclpy.md",sourceDirName:"week-3-5",slug:"/week-3-5/ros2-python-rclpy",permalink:"/New-Physical-AI-and-Humanoid-Robotics/docs/week-3-5/ros2-python-rclpy",draft:!1,unlisted:!1,editUrl:"https://github.com/JaveriaNigar/New-Physical-AI-and-Humanoid-Robotics/docs/week-3-5/ros2-python-rclpy.md",tags:[{label:"ROS 2",permalink:"/New-Physical-AI-and-Humanoid-Robotics/docs/tags/ros-2"},{label:"Python",permalink:"/New-Physical-AI-and-Humanoid-Robotics/docs/tags/python"},{label:"rclpy",permalink:"/New-Physical-AI-and-Humanoid-Robotics/docs/tags/rclpy"},{label:"Robotics",permalink:"/New-Physical-AI-and-Humanoid-Robotics/docs/tags/robotics"},{label:"Programming",permalink:"/New-Physical-AI-and-Humanoid-Robotics/docs/tags/programming"}],version:"current",frontMatter:{title:"ROS 2 with Python - rclpy Usage",description:"Introduction to using ROS 2 with Python through the rclpy client library",tags:["ROS 2","Python","rclpy","Robotics","Programming"]}},c={},o=[{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"Introduction to rclpy",id:"introduction-to-rclpy",level:2},{value:"Diagrams",id:"diagrams",level:2},{value:"rclpy Architecture",id:"rclpy-architecture",level:3},{value:"Basic Node Structure",id:"basic-node-structure",level:3},{value:"Setting Up Python for ROS 2",id:"setting-up-python-for-ros-2",level:2},{value:"Prerequisites",id:"prerequisites",level:3},{value:"ROS 2 Environment Setup",id:"ros-2-environment-setup",level:3},{value:"Creating Your First ROS 2 Node with rclpy",id:"creating-your-first-ros-2-node-with-rclpy",level:2},{value:"Code Explanation",id:"code-explanation",level:3},{value:"Publishers and Subscribers",id:"publishers-and-subscribers",level:2},{value:"Publishing Messages",id:"publishing-messages",level:3},{value:"Subscribing to Messages",id:"subscribing-to-messages",level:3},{value:"Quality of Service (QoS) in Python",id:"quality-of-service-qos-in-python",level:3},{value:"Services in rclpy",id:"services-in-rclpy",level:2},{value:"Service Server",id:"service-server",level:3},{value:"Service Client",id:"service-client",level:3},{value:"Actions in rclpy",id:"actions-in-rclpy",level:2},{value:"Action Server",id:"action-server",level:3},{value:"Action Client",id:"action-client",level:3},{value:"Parameters in rclpy",id:"parameters-in-rclpy",level:2},{value:"Working with Custom Message Types",id:"working-with-custom-message-types",level:2},{value:"Debugging rclpy Nodes",id:"debugging-rclpy-nodes",level:2},{value:"Logging",id:"logging",level:3},{value:"Common Debugging Techniques",id:"common-debugging-techniques",level:3},{value:"Best Practices for rclpy Development",id:"best-practices-for-rclpy-development",level:2},{value:"Code Organization",id:"code-organization",level:3},{value:"Error Handling",id:"error-handling",level:3},{value:"Performance Considerations",id:"performance-considerations",level:3},{value:"Testing",id:"testing",level:3},{value:"Exercises",id:"exercises",level:2},{value:"Quiz",id:"quiz",level:2},{value:"Reflection",id:"reflection",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"ros-2-with-python---rclpy-usage",children:"ROS 2 with Python - rclpy Usage"}),"\n",(0,i.jsx)(n.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,i.jsx)(n.p,{children:"By the end of this chapter, students will be able to:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Set up a Python environment for ROS 2 development"}),"\n",(0,i.jsx)(n.li,{children:"Create ROS 2 nodes using the rclpy client library"}),"\n",(0,i.jsx)(n.li,{children:"Implement publishers and subscribers in Python"}),"\n",(0,i.jsx)(n.li,{children:"Create service clients and servers in Python"}),"\n",(0,i.jsx)(n.li,{children:"Create action clients and servers in Python"}),"\n",(0,i.jsx)(n.li,{children:"Implement parameter usage in Python nodes"}),"\n",(0,i.jsx)(n.li,{children:"Debug and test Python-based ROS 2 nodes"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"introduction-to-rclpy",children:"Introduction to rclpy"}),"\n",(0,i.jsx)(n.p,{children:"rclpy is the Python client library for ROS 2, providing Python bindings for the ROS 2 middleware. It allows developers to create ROS 2 nodes, publishers, subscribers, services, and actions using Python. Python is an excellent choice for ROS 2 development due to its ease of use, extensive libraries, and rapid prototyping capabilities."}),"\n",(0,i.jsx)(n.p,{children:"The rclpy library provides a Pythonic interface to ROS 2 concepts while maintaining compatibility with other ROS 2 client libraries like rclcpp (C++)."}),"\n",(0,i.jsx)(n.h2,{id:"diagrams",children:"Diagrams"}),"\n",(0,i.jsx)(n.h3,{id:"rclpy-architecture",children:"rclpy Architecture"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-mermaid",children:"graph TD\r\n    A[rclpy - Python Client Library] --\x3e B[rcl - Common Library]\r\n    B --\x3e C[rmw - ROS Middleware]\r\n    C --\x3e D[DDS Implementation]\r\n\r\n    style A fill:#cde4ff\r\n    style D fill:#f0e6ff\n"})}),"\n",(0,i.jsx)(n.h3,{id:"basic-node-structure",children:"Basic Node Structure"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-mermaid",children:"graph TD\r\n    A[Node] --\x3e B[Timer]\r\n    A --\x3e C[Publishers]\r\n    A --\x3e D[Subscribers]\r\n    A --\x3e E[Service Clients]\r\n    A --\x3e F[Service Servers]\r\n    A --\x3e G[Action Clients]\r\n    A --\x3e H[Action Servers]\r\n    A --\x3e I[Parameters]\r\n\r\n    B --\x3e J[Callback Functions]\r\n    D --\x3e J\r\n    G --\x3e J\r\n    H --\x3e J\n"})}),"\n",(0,i.jsx)(n.h2,{id:"setting-up-python-for-ros-2",children:"Setting Up Python for ROS 2"}),"\n",(0,i.jsx)(n.h3,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,i.jsx)(n.p,{children:"Before developing with rclpy, ensure you have:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"A working ROS 2 installation (Humble Hawksbill or newer)"}),"\n",(0,i.jsx)(n.li,{children:"Python 3.8 or higher"}),"\n",(0,i.jsx)(n.li,{children:"pip for package management"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"ros-2-environment-setup",children:"ROS 2 Environment Setup"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Source the ROS 2 setup script\r\nsource /opt/ros/humble/setup.bash  # or your ROS 2 distribution name\r\n\r\n# Create a workspace\r\nmkdir -p ~/ros2_workspace/src\r\ncd ~/ros2_workspace\r\n\r\n# Source workspace (if you have custom packages)\r\nsource install/setup.bash\n"})}),"\n",(0,i.jsx)(n.h2,{id:"creating-your-first-ros-2-node-with-rclpy",children:"Creating Your First ROS 2 Node with rclpy"}),"\n",(0,i.jsx)(n.p,{children:"A ROS 2 node is a process that performs computation. Here's a basic example of creating a node:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",metastring:'title="minimal_publisher.py"',children:"import rclpy\r\nfrom rclpy.node import Node\r\nfrom std_msgs.msg import String\r\n\r\n\r\nclass MinimalPublisher(Node):\r\n    def __init__(self):\r\n        super().__init__('minimal_publisher')\r\n        self.publisher_ = self.create_publisher(String, 'topic', 10)\r\n        timer_period = 0.5  # seconds\r\n        self.timer = self.create_timer(timer_period, self.timer_callback)\r\n        self.i = 0\r\n\r\n    def timer_callback(self):\r\n        msg = String()\r\n        msg.data = f'Hello World: {self.i}'\r\n        self.publisher_.publish(msg)\r\n        self.get_logger().info(f'Publishing: \"{msg.data}\"')\r\n        self.i += 1\r\n\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n\r\n    minimal_publisher = MinimalPublisher()\r\n\r\n    rclpy.spin(minimal_publisher)\r\n\r\n    minimal_publisher.destroy_node()\r\n    rclpy.shutdown()\r\n\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,i.jsx)(n.h3,{id:"code-explanation",children:"Code Explanation"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Import statements"}),": Import rclpy and the necessary message types"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Node class"}),": Create a class that inherits from ",(0,i.jsx)(n.code,{children:"rclpy.node.Node"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Initialization"}),": Call ",(0,i.jsx)(n.code,{children:"super().__init__()"})," with a unique node name"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Create publisher"}),": Use ",(0,i.jsx)(n.code,{children:"create_publisher()"})," to create a publisher"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Create timer"}),": Use ",(0,i.jsx)(n.code,{children:"create_timer()"})," to create a periodic callback"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Timer callback"}),": Function called periodically to publish messages"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Main function"}),": Initialize, run, and cleanup"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"publishers-and-subscribers",children:"Publishers and Subscribers"}),"\n",(0,i.jsx)(n.h3,{id:"publishing-messages",children:"Publishing Messages"}),"\n",(0,i.jsx)(n.p,{children:"Publishers send messages to topics. The publisher we created earlier demonstrates the basic usage:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# Create a publisher with message type String, topic name 'topic', and QoS history depth 10\r\nself.publisher_ = self.create_publisher(String, 'topic', 10)\r\n\r\n# In the callback, create and publish a message\r\nmsg = String()\r\nmsg.data = \"Hello World\"\r\nself.publisher_.publish(msg)\n"})}),"\n",(0,i.jsx)(n.h3,{id:"subscribing-to-messages",children:"Subscribing to Messages"}),"\n",(0,i.jsx)(n.p,{children:"Subscribers receive messages from topics:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",metastring:'title="minimal_subscriber.py"',children:"import rclpy\r\nfrom rclpy.node import Node\r\nfrom std_msgs.msg import String\r\n\r\n\r\nclass MinimalSubscriber(Node):\r\n    def __init__(self):\r\n        super().__init__('minimal_subscriber')\r\n        self.subscription = self.create_subscription(\r\n            String,\r\n            'topic',\r\n            self.listener_callback,\r\n            10)\r\n        self.subscription  # prevent unused variable warning\r\n\r\n    def listener_callback(self, msg):\r\n        self.get_logger().info(f'I heard: \"{msg.data}\"')\r\n\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n\r\n    minimal_subscriber = MinimalSubscriber()\r\n\r\n    rclpy.spin(minimal_subscriber)\r\n\r\n    minimal_subscriber.destroy_node()\r\n    rclpy.shutdown()\r\n\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,i.jsx)(n.h3,{id:"quality-of-service-qos-in-python",children:"Quality of Service (QoS) in Python"}),"\n",(0,i.jsx)(n.p,{children:"QoS settings can be specified when creating publishers and subscribers:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"from rclpy.qos import QoSProfile, ReliabilityPolicy, DurabilityPolicy\r\n\r\n# Create a custom QoS profile\r\nqos_profile = QoSProfile(\r\n    depth=10,\r\n    reliability=ReliabilityPolicy.RELIABLE,\r\n    durability=DurabilityPolicy.VOLATILE\r\n)\r\n\r\n# Use the QoS profile when creating publisher/subscriber\r\npublisher = self.create_publisher(String, 'topic', qos_profile)\n"})}),"\n",(0,i.jsx)(n.h2,{id:"services-in-rclpy",children:"Services in rclpy"}),"\n",(0,i.jsx)(n.p,{children:"Services implement a request-response pattern for synchronous communication."}),"\n",(0,i.jsx)(n.h3,{id:"service-server",children:"Service Server"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",metastring:'title="add_two_ints_server.py"',children:"from example_interfaces.srv import AddTwoInts\r\nimport rclpy\r\nfrom rclpy.node import Node\r\n\r\n\r\nclass MinimalService(Node):\r\n    def __init__(self):\r\n        super().__init__('minimal_service')\r\n        self.srv = self.create_service(AddTwoInts, 'add_two_ints', self.add_two_ints_callback)\r\n\r\n    def add_two_ints_callback(self, request, response):\r\n        response.sum = request.a + request.b\r\n        self.get_logger().info(f'Returning {request.a} + {request.b} = {response.sum}')\r\n        return response\r\n\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n\r\n    minimal_service = MinimalService()\r\n\r\n    rclpy.spin(minimal_service)\r\n\r\n    rclpy.shutdown()\r\n\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,i.jsx)(n.h3,{id:"service-client",children:"Service Client"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",metastring:'title="add_two_ints_client.py"',children:"from example_interfaces.srv import AddTwoInts\r\nimport rclpy\r\nfrom rclpy.node import Node\r\n\r\n\r\nclass MinimalClient(Node):\r\n    def __init__(self):\r\n        super().__init__('minimal_client')\r\n        self.cli = self.create_client(AddTwoInts, 'add_two_ints')\r\n        while not self.cli.wait_for_service(timeout_sec=1.0):\r\n            self.get_logger().info('service not available, waiting again...')\r\n        self.req = AddTwoInts.Request()\r\n\r\n    def send_request(self, a, b):\r\n        self.req.a = a\r\n        self.req.b = b\r\n        self.future = self.cli.call_async(self.req)\r\n        rclpy.spin_until_future_complete(self, self.future)\r\n        return self.future.result()\r\n\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n\r\n    minimal_client = MinimalClient()\r\n    response = minimal_client.send_request(1, 2)\r\n    minimal_client.get_logger().info(\r\n        f'Result of add_two_ints: {response.sum}')\r\n\r\n    minimal_client.destroy_node()\r\n    rclpy.shutdown()\r\n\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,i.jsx)(n.h2,{id:"actions-in-rclpy",children:"Actions in rclpy"}),"\n",(0,i.jsx)(n.p,{children:"Actions are used for long-running tasks with feedback and the ability to cancel."}),"\n",(0,i.jsx)(n.h3,{id:"action-server",children:"Action Server"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",metastring:'title="fibonacci_action_server.py"',children:"from rclpy.action import ActionServer, CancelResponse, GoalResponse\r\nfrom rclpy.callback_groups import ReentrantCallbackGroup\r\nfrom rclpy.executors import MultiThreadedExecutor\r\nfrom rclpy.node import Node\r\nfrom example_interfaces.action import Fibonacci\r\n\r\n\r\nclass FibonacciActionServer(Node):\r\n    def __init__(self):\r\n        super().__init__('fibonacci_action_server')\r\n        self._action_server = ActionServer(\r\n            self,\r\n            Fibonacci,\r\n            'fibonacci',\r\n            execute_callback=self.execute_callback,\r\n            callback_group=ReentrantCallbackGroup(),\r\n            goal_callback=self.goal_callback,\r\n            cancel_callback=self.cancel_callback)\r\n\r\n    def destroy(self):\r\n        self._action_server.destroy()\r\n        super().destroy_node()\r\n\r\n    def goal_callback(self, goal_request):\r\n        self.get_logger().info('Received goal request')\r\n        return GoalResponse.ACCEPT\r\n\r\n    def cancel_callback(self, goal_handle):\r\n        self.get_logger().info('Received cancel request')\r\n        return CancelResponse.ACCEPT\r\n\r\n    def execute_callback(self, goal_handle):\r\n        self.get_logger().info('Executing goal...')\r\n\r\n        feedback_msg = Fibonacci.Feedback()\r\n        feedback_msg.sequence = [0, 1]\r\n\r\n        for i in range(1, goal_handle.request.order):\r\n            if goal_handle.is_cancel_requested:\r\n                goal_handle.canceled()\r\n                self.get_logger().info('Goal canceled')\r\n                return Fibonacci.Result()\r\n\r\n            feedback_msg.sequence.append(\r\n                feedback_msg.sequence[i] + feedback_msg.sequence[i-1])\r\n\r\n            self.get_logger().info(f'Publishing feedback: {feedback_msg.sequence}')\r\n            goal_handle.publish_feedback(feedback_msg)\r\n\r\n        goal_handle.succeed()\r\n        result = Fibonacci.Result()\r\n        result.sequence = feedback_msg.sequence\r\n        self.get_logger().info(f'Returning result: {result.sequence}')\r\n\r\n        return result\r\n\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n\r\n    fibonacci_action_server = FibonacciActionServer()\r\n\r\n    executor = MultiThreadedExecutor()\r\n    rclpy.spin(fibonacci_action_server, executor=executor)\r\n\r\n    fibonacci_action_server.destroy()\r\n    rclpy.shutdown()\r\n\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,i.jsx)(n.h3,{id:"action-client",children:"Action Client"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",metastring:'title="fibonacci_action_client.py"',children:"from rclpy.action import ActionClient\r\nfrom rclpy.node import Node\r\nfrom example_interfaces.action import Fibonacci\r\n\r\n\r\nclass FibonacciActionClient(Node):\r\n    def __init__(self):\r\n        super().__init__('fibonacci_action_client')\r\n        self._action_client = ActionClient(\r\n            self,\r\n            Fibonacci,\r\n            'fibonacci')\r\n\r\n    def send_goal(self, order):\r\n        goal_msg = Fibonacci.Goal()\r\n        goal_msg.order = order\r\n\r\n        self._action_client.wait_for_server()\r\n\r\n        self._send_goal_future = self._action_client.send_goal_async(\r\n            goal_msg,\r\n            feedback_callback=self.feedback_callback)\r\n\r\n        self._send_goal_future.add_done_callback(self.goal_response_callback)\r\n\r\n    def goal_response_callback(self, future):\r\n        goal_handle = future.result()\r\n        if not goal_handle.accepted:\r\n            self.get_logger().info('Goal rejected :(')\r\n            return\r\n\r\n        self.get_logger().info('Goal accepted :)')\r\n\r\n        self._get_result_future = goal_handle.get_result_async()\r\n        self._get_result_future.add_done_callback(self.get_result_callback)\r\n\r\n    def get_result_callback(self, future):\r\n        result = future.result().result\r\n        self.get_logger().info(f'Result: {result.sequence}')\r\n        rclpy.shutdown()\r\n\r\n    def feedback_callback(self, feedback_msg):\r\n        feedback = feedback_msg.feedback\r\n        self.get_logger().info(f'Received feedback: {feedback.sequence}')\r\n\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n\r\n    action_client = FibonacciActionClient()\r\n    action_client.send_goal(10)\r\n\r\n    rclpy.spin(action_client)\r\n\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,i.jsx)(n.h2,{id:"parameters-in-rclpy",children:"Parameters in rclpy"}),"\n",(0,i.jsx)(n.p,{children:"Parameters allow nodes to be configured at runtime:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",metastring:'title="parameter_node.py"',children:"import rclpy\r\nfrom rclpy.node import Node\r\n\r\n\r\nclass ParameterNode(Node):\r\n    def __init__(self):\r\n        super().__init__('parameter_node')\r\n\r\n        # Declare parameters with default values\r\n        self.declare_parameter('my_parameter', 'default_value')\r\n        self.declare_parameter('integer_param', 42)\r\n        self.declare_parameter('double_param', 3.14)\r\n        self.declare_parameter('boolean_param', True)\r\n\r\n        # Get parameter values\r\n        my_param = self.get_parameter('my_parameter').value\r\n        self.get_logger().info(f'My parameter: {my_param}')\r\n\r\n        # Set a callback for parameter changes\r\n        self.add_on_set_parameters_callback(self.parameter_callback)\r\n\r\n    def parameter_callback(self, params):\r\n        for param in params:\r\n            self.get_logger().info(f'Parameter {param.name} changed to {param.value}')\r\n        return SetParametersResult(successful=True)\r\n\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n\r\n    parameter_node = ParameterNode()\r\n\r\n    rclpy.spin(parameter_node)\r\n\r\n    parameter_node.destroy_node()\r\n    rclpy.shutdown()\r\n\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,i.jsx)(n.h2,{id:"working-with-custom-message-types",children:"Working with Custom Message Types"}),"\n",(0,i.jsx)(n.p,{children:"To use custom message types, you need to define them in a package and install them:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Create a package with ",(0,i.jsx)(n.code,{children:".msg"})," files in the ",(0,i.jsx)(n.code,{children:"msg/"})," directory"]}),"\n",(0,i.jsxs)(n.li,{children:["Add the message definition to ",(0,i.jsx)(n.code,{children:"CMakeLists.txt"})," or ",(0,i.jsx)(n.code,{children:"setup.py"})]}),"\n",(0,i.jsxs)(n.li,{children:["Build the package: ",(0,i.jsx)(n.code,{children:"colcon build"})]}),"\n",(0,i.jsxs)(n.li,{children:["Source the setup files: ",(0,i.jsx)(n.code,{children:"source install/setup.bash"})]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Example custom message definition in msg/Num.msg\r\nint64 num\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# Use the custom message\r\nfrom my_package.msg import Num\r\n\r\n# Create and use the message\r\nmsg = Num()\r\nmsg.num = 42\r\npublisher.publish(msg)\n"})}),"\n",(0,i.jsx)(n.h2,{id:"debugging-rclpy-nodes",children:"Debugging rclpy Nodes"}),"\n",(0,i.jsx)(n.h3,{id:"logging",children:"Logging"}),"\n",(0,i.jsx)(n.p,{children:"Use the built-in logging capabilities:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# Different log levels\r\nself.get_logger().debug('This is a debug message')\r\nself.get_logger().info('This is an info message')\r\nself.get_logger().warn('This is a warning message')\r\nself.get_logger().error('This is an error message')\r\nself.get_logger().fatal('This is a fatal message')\n"})}),"\n",(0,i.jsx)(n.h3,{id:"common-debugging-techniques",children:"Common Debugging Techniques"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Print/Log statements"}),": Add logging to track execution flow"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"ROS 2 tools"}),": Use ",(0,i.jsx)(n.code,{children:"ros2 topic echo"}),", ",(0,i.jsx)(n.code,{children:"ros2 service call"}),", etc."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Python debugger"}),": Use ",(0,i.jsx)(n.code,{children:"pdb"})," for interactive debugging:"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import pdb\r\npdb.set_trace()  # Set breakpoint\n"})}),"\n",(0,i.jsx)(n.h2,{id:"best-practices-for-rclpy-development",children:"Best Practices for rclpy Development"}),"\n",(0,i.jsx)(n.h3,{id:"code-organization",children:"Code Organization"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Use proper Python package structure"}),"\n",(0,i.jsx)(n.li,{children:"Separate different components into different files"}),"\n",(0,i.jsx)(n.li,{children:"Use meaningful names for nodes, topics, and services"}),"\n",(0,i.jsx)(n.li,{children:"Follow Python naming conventions (PEP 8)"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"error-handling",children:"Error Handling"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Handle exceptions appropriately"}),"\n",(0,i.jsx)(n.li,{children:"Check for service availability before making calls"}),"\n",(0,i.jsx)(n.li,{children:"Handle node shutdown gracefully"}),"\n",(0,i.jsx)(n.li,{children:"Validate input parameters"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"performance-considerations",children:"Performance Considerations"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Minimize data copying in callbacks"}),"\n",(0,i.jsx)(n.li,{children:"Use appropriate QoS settings for your use case"}),"\n",(0,i.jsx)(n.li,{children:"Be aware of callback execution times"}),"\n",(0,i.jsx)(n.li,{children:"Consider threading for CPU-intensive operations"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"testing",children:"Testing"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Use ",(0,i.jsx)(n.code,{children:"launch"})," system for integration testing"]}),"\n",(0,i.jsx)(n.li,{children:"Write unit tests for individual components"}),"\n",(0,i.jsx)(n.li,{children:"Test with realistic message rates"}),"\n",(0,i.jsx)(n.li,{children:"Test error conditions and recovery"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"exercises",children:"Exercises"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Create a publisher that publishes the current time to a topic every second, and a subscriber that prints the received time."}),"\n",(0,i.jsx)(n.li,{children:"Implement a service server that converts temperatures between Celsius and Fahrenheit, and a client that uses this service."}),"\n",(0,i.jsx)(n.li,{children:"Design and implement a custom message type for exchanging robot pose information (position and orientation)."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"quiz",children:"Quiz"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"What is rclpy?"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"A) A C++ client library for ROS 2"}),"\n",(0,i.jsx)(n.li,{children:"B) A Python client library for ROS 2"}),"\n",(0,i.jsx)(n.li,{children:"C) A communication protocol for robots"}),"\n",(0,i.jsx)(n.li,{children:"D) A visualization tool for ROS 2"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"How do you create a publisher in rclpy?"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["A) ",(0,i.jsx)(n.code,{children:"self.create_publisher(message_type, topic_name, queue_size)"})]}),"\n",(0,i.jsxs)(n.li,{children:["B) ",(0,i.jsx)(n.code,{children:"rclpy.create_publisher(node, message_type, topic_name)"})]}),"\n",(0,i.jsxs)(n.li,{children:["C) ",(0,i.jsx)(n.code,{children:"Publisher(message_type, topic_name)"})]}),"\n",(0,i.jsxs)(n.li,{children:["D) ",(0,i.jsx)(n.code,{children:"self.publisher(message_type, topic_name, queue_size)"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"What is the purpose of Quality of Service (QoS) settings in ROS 2?"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"A) To limit the amount of memory used by nodes"}),"\n",(0,i.jsx)(n.li,{children:"B) To configure communication behavior like reliability and durability"}),"\n",(0,i.jsx)(n.li,{children:"C) To specify the programming language used"}),"\n",(0,i.jsx)(n.li,{children:"D) To determine which nodes can communicate with each other"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"reflection",children:"Reflection"}),"\n",(0,i.jsx)(n.p,{children:"Consider the advantages and disadvantages of using Python versus C++ for ROS 2 development. When would you choose one over the other? What types of robot applications might benefit from Python's ease of use versus C++'s performance? How does rclpy facilitate rapid prototyping in robotics development?"})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>t,x:()=>a});var i=r(6540);const s={},l=i.createContext(s);function t(e){const n=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);